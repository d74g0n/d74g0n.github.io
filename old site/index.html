<!DOCTYPE html>
<!--
    Makes space like background with image signature overlay.

Todo:   Make mobile happy signature overlay.
    
-->

<html lang="en">
	<head>
		<title>d74g0n Spaces</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		
                        <link rel="shortcut icon" href="favicon.ico"> 
                
                <style>
			body {
				color: #ffffff;
				font-family:Monospace;
				font-size:13px;
				text-align:center;
				font-weight: bold;
				background-color: #000000;
				margin: 0px;
				overflow: visible;
                                z-index: 0;
                                width: 100%;
                                height: 1000px;
			}
                        #signature{
/*                                position: absolute;
                                padding-top: auto;
                                padding-bottom: auto;
                                padding-left: auto;
                                padding-right: auto;
                                margin: auto;*/
                                z-index: 1;
                                height: 1000px;
                                overflow: visible;
                        }
                        #container{
                                position: static;
                                z-index: 1;
                        }
                        #iframec{
                            width: 100%;
                            height: 1000px;
                            overflow: hidden;
                            overflow-y: no-display;
                            height: 1080px;
                            overflow-style: move;
                        }
		</style>
	</head>

        <body onresize=mesizer()>
        <div id="signature">
            <center>
<!--                    <img src="./signature.png" alt="d74g0n signature" id="overlayc">-->
                     <iframe name="iframer" id="iframec" scrolling="yes" frameborder="yes" src="http://d74g0n.com" allowfullscreen=""></iframe>
            </center>
        </div>
        <div id="container">               
            <script src="./js/three.js"></script>
            <script src="./js/Detector.js"></script>
<!--		<script src="./js/stats.min.js"></script>-->
            <script id="vertexShader" type="x-shader/x-vertex">
                    void main()	{
                            gl_Position = vec4( position, 1.0 );
                    }
            </script>
            <script id="fragmentShader" type="x-shader/x-fragment">
#ifdef GL_ES
precision mediump float;
#endif

uniform float time;
uniform vec2 mouse;
uniform vec2 resolution;

// Star Nest by Pablo Rom√°n Andrioli
// Modified a lot.

// This content is under the MIT License.

#define iterations 15
#define formuparam 0.340

#define volsteps 12
#define stepsize 0.110

#define zoom   0.8
#define tile   0.750
#define speed  100.5

#define brightness 0.0017
#define darkmatter 0.400
#define distfading 0.960
#define saturation 1.9


void main(void)
{
	//get coords and direction
	vec2 uv=gl_FragCoord.xy/resolution.xy-.5;
	uv.y*=resolution.y/resolution.x;
	vec3 dir=vec3(uv*zoom,1.);
	
	float a2=time*speed+.5;
	float a1=0.0;
	mat2 rot1=mat2(cos(a1),sin(a1),-sin(a1),cos(a1));
	mat2 rot2=rot1;
        
	dir.xz*=rot1;
	dir.xy*=rot2;
	
	//from.x-=time;
	//mouse movement
	vec3 from=vec3(0.,0.,0.);
	from+=vec3(0,.1*time,0); //movement of stars
		
	from.xz*=rot1;
	from.xy*=rot2;
	
	//volumetric rendering
	float s=.1,fade=.07;
	vec3 v=vec3(0.4);
	for (int r=0; r<volsteps; r++) {
		vec3 p=from+s*dir*1.5;
		p = abs(vec3(tile)-mod(p,vec3(tile*2.))); // tiling fold
		p.x+=float(r*r)*0.01;
		p.y+=float(r)*0.02;
		float pa,a=pa=0.;
		for (int i=0; i<iterations; i++) { 
			p=abs(p)/dot(p,p)-formuparam; // the magic formula
			a+=abs(length(p)-pa*0.2); // absolute sum of average change
			pa=length(p);
		}
		//float dm=max(0.,darkmatter-a*a*.001); //dark matter
		a*=a*a*2.; // add contrast
		//if (r>3) fade*=1.-dm; // dark matter, don't render near
		//v+=vec3(dm,dm*.5,0.);
		//v+=fade;
		v+=vec3(s,s*s,s*s*s*s)*a*brightness*fade; // coloring based on distance
		fade*=distfading; // distance fading
		s+=stepsize;
	}
	v=mix(vec3(length(v)),v,saturation); //color adjust
	
        
        gl_FragColor = vec4(v*.01,1.);	 //messes with colour
	
}
                </script>
                
		<script>
			if ( ! Detector.webgl ) Detector.addGetWebGLMessage();
			var container, stats;
			var camera, scene, renderer;
			var uniforms;
			init();
			animate();
			function init() {
				container = document.getElementById( 'container' );
				camera = new THREE.Camera();
				camera.position.z = 1;
				scene = new THREE.Scene();
				var geometry = new THREE.PlaneBufferGeometry( 2, 2 );
				uniforms = {
					time: { type: "f", value: 1.0 },
					resolution: { type: "v2", value: new THREE.Vector2() }
				};
				var material = new THREE.ShaderMaterial( {
					uniforms: uniforms,
					vertexShader: document.getElementById( 'vertexShader' ).textContent,
					fragmentShader: document.getElementById( 'fragmentShader' ).textContent
				} );
				var mesh = new THREE.Mesh( geometry, material );
				scene.add( mesh );
				renderer = new THREE.WebGLRenderer();
				renderer.setPixelRatio( window.devicePixelRatio );
				container.appendChild( renderer.domElement );
//				stats = new Stats();
//				container.appendChild( stats.dom );
				onWindowResize();
				window.addEventListener( 'resize', onWindowResize, false );
			}
			function onWindowResize( event ) {
				renderer.setSize( window.innerWidth, window.innerHeight );
				uniforms.resolution.value.x = renderer.domElement.width;
				uniforms.resolution.value.y = renderer.domElement.height;
			}
			//
			function animate() {
				requestAnimationFrame( animate );
				render();
//				stats.update();
			}
			function render() {
				uniforms.time.value += 0.05;
				renderer.render( scene, camera );
			}
		</script>

        <script>
            
        function mesizer() {
            var canvas = null;
            canvas = document.getElementById("iframec");
            canvas.height = window.innerHeight;
            canvas.width = window.innerWidth;
        }
            
            mesizer();
            
        </script>
        
    </div>
	</body>
</html>