<!DOCTYPE html>
<html>

<head>
    <title>32x32 Map Maker</title>
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0">
    <meta name="description" content="I AM d74g0n!">
    <meta name="keywords" content="d74g0n">
    <meta name="robots" content="noarchive" />
    <meta charset="UTF-8">
    <meta name="author" content="d74g0n">
    <meta property="og:image" content="index.png">
    <meta name="twitter:image" content="index.png">
    <link rel="shortcut icon" href="/common/img/favicon.ico" />
    <link href='index.css' rel='stylesheet' type='text/css'>

    <style>


    </style>
</head>
<script src="/common/js/draggable_element.js"></script>

<!--
<div id="hiddencopyhelper">
</div>
-->
    
    <input type="text" value="Hello World" id="hiddencopyhelper">
    
<script>
    // HOOKINTO THINGS IM TOO TIRED!:  GIVE HTML BUTTON BASICALLY.
    function copyHelper() {
        /* Get the text field */
        var copyText = document.getElementById("hiddencopyhelper");
        copyText.value = gridEditor.exportMap().toString();
        /* Select the text field */
        copyText.select();
//        copyText.setSelectionRange(0, 99999); /*For mobile devices*/
        /* Copy the text inside the text field */
        document.execCommand("copy");
        /* Alert the copied text */
//        alert("Copied the text: " + copyText.value);
    }
</script>


<body>

    <canvas id="tilechoice"></canvas>
    <canvas id="mainscreen"></canvas>
    <canvas id="spritecanvas"></canvas>
    <script src="/games/common/drawing.js"></script>
    <script src="/games/common/_Math.js"></script>
    <!--EXAMPLES::-->
    <script src="pics.js"></script>

    <script>
        const canvas = document.getElementById("mainscreen");
        const ctx = canvas.getContext("2d");
        ctx.imageSmoothingEnabled = false;
    </script>

    <script src="grid.js"></script>
    <script src="gridEditor.js"></script>



    <div id="displayData">
        <center>
            <div id='layerFrame'>
                <!--                <hr>-->

                <a id='lbtn' onclick='mapData.init()'>
                    <center>N</center>
                </a>

                <a id='lbtn' onclick='drawPic()'>
                    <center>Ex</center>
                </a>

                <a id='lbtn' onclick='gridEditor.clear()'>
                    <center>C</center>
                </a>

                <hr>

                <span id="infotitle">ACTIVE LAYER<span id="info"></span><br></span><a id='lbtn' onclick='grid.layerDOWN()'>
                    <center>-</center>
                    <a id="layerData" class="bigData">[0]</a>
                </a><a id='lbtn' onclick='grid.layerUP()'>
                    <center>+</center>
                </a>
            </div>
        </center>


        <span id="info">CELL: </span> <a id="cellData">[x,y]</a>

        <!--        <br><br><span id="infotitle">-=[ SPRITE:</span>-->
        <br><span id="info">SPRITE: </span> <span id="spriteData">[x,y]</span>
        <br><span id="info">HINT: </span> <a id="stateData"> ExAMPLE</a>
        <br><span id="info">ACTION: </span> <a id="stateData">DRAW</a>
        <hr>
        <div id="toggleSolo"><a id="viewbtn" onclick="mapData.toggleRenderType()"> VIEW MODE</a></div>
        <center>
            <div id="but2">
                <!--        <sprite>-=[ TOOLBAR</sprite>-->
                <center>
                    <a id='btn' onclick='gridEditor.eraseTile()'>
                        <center>ERASE</center>
                    </a>
                    <a id='btn' onclick='gridEditor.fillLayer()'>
                        <center>FILL</center>
                    </a>
                    <a id='btn' onclick='gridEditor.clear()'>
                        <center>CLEAR</center>
                    </a>
                </center>
            </div>
        </center>
        <script>
            dragElement(document.getElementById("displayData"));
        </script>
    </div>


    <script>
        const tanvas = document.getElementById("tilechoice");
        const ttx = tanvas.getContext("2d");
        tanvas.height = 128;
        tanvas.width = 128;
        ttx.imageSmoothingEnabled = false;
    </script>

    <script src="myTile.js"></script>

    <script>
        const sanvas = document.getElementById("spritecanvas");
        const stx = sanvas.getContext("2d");

        function loadImage(path) {
            let image = new Image();
            image.src = path;
            image.onload = function() {
                sanvas.width = this.width;
                sanvas.height = this.height;
                stx.drawImage(this, 0, 0, this.width, this.height, 0, 0, sanvas.width, sanvas.height, );
            };
            return image;
        }

        // let spritesheet = loadImage(`/games/tileparty/img/Voirol.png`)
        let spritesheet = loadImage(`/games/tileparty/img/spritesheetAlpha2.png`);

        sanvas.width = spritesheet.width;
        sanvas.height = spritesheet.height;

        sanvas.onclick = function(evt) {
            var rect = canvas.getBoundingClientRect();
            let pos = {
                x: evt.layerX,
                y: evt.layerY,
                scale: (spritesheet.width / 48),
                scaleH: (spritesheet.height / 22),
            };

            let coord = [Math.floor(pos.x / pos.scale), Math.floor(pos.y / pos.scale)];

            document.getElementById("spriteData").innerHTML = `[${coord}]`;

            myTile.x = coord[0];
            myTile.y = coord[1];
            ttx.clearRect(0, 0, tanvas.width, tanvas.height);
            stx.clearRect(0, 0, sanvas.width, sanvas.height);
            myTile.draw();

            console.log(`sanvas[${Math.floor(pos.x/pos.scale)},${Math.floor(pos.y/pos.scale)}]`);

            stx.drawImage(spritesheet, 0, 0);

            stx.save();
            stx.beginPath();
            stx.lineWidth = 1;
            stx.strokeStyle = 'white';
            stx.strokeRect(coord[0] * pos.scale, coord[1] * pos.scale, pos.scale, pos.scale);
            stx.stroke();
            stx.closePath();
            stx.restore();
        }

        dragElement(tanvas);
        dragElement(sanvas);
    </script>
    <script src="mapData.js"></script>
</body></html>
