<!DOCTYPE html>
<html>

<head>
    <title>32x32 Map Maker</title>
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0">
    <meta name="description" content="I AM d74g0n!">
    <meta name="keywords" content="d74g0n">
    <meta name="robots" content="noarchive" />
    <meta charset="UTF-8">
    <meta name="author" content="d74g0n">
    <meta property="og:image" content="index.png">
    <meta name="twitter:image" content="index.png">
    <link rel="shortcut icon" href="/common/img/favicon.ico" />

    <style>
        @font-face {
            font-family: '8bitO';
            src: url('/common/fonts/8bitOperatorPlus-Regular.ttf');
        }

        * {
            font-family: '8bitO';
        }

        body {
            background: black;
            overflow: hidden;
        }

        canvas {
            display: inline;
            border: 2px solid white;
            position: absolute;
        }

        #coord {
            color: gold;
        }

        #solve {
            color: #00aeba;
            height: 4em;
            overflow: hidden;
        }

        #mainscreen {
            align-self: center;
            top: 1px;
            left: 1px;
            width: 600px;
            height: 600px;
        }

        #tilechoice {
            z-index: 10;
            top: 1px;
            left: 613px;
            width: 256px;
            height: 256px;
        }

        #spritecanvas {
            top:613px;
            left: 1px;
            
            
        }


    </style>
</head>

<body>

    <canvas id="tilechoice"></canvas>
    <canvas id="mainscreen"></canvas>

    <canvas id="spritecanvas"></canvas>
    <script src="/games/common/drawing.js"></script>
    <script src="/games/common/_Math.js"></script>
    <script src="/common/js/draggable_element.js"></script>

    <script>
        const canvas = document.getElementById("mainscreen");
        const ctx = canvas.getContext("2d");

        ctx.imageSmoothingEnabled = false;

    </script>

    <script src="grid.js"></script>
    <script src="gridEditor.js"></script>
    <script src="mapData.js"></script>
    <script>
        const tanvas = document.getElementById("tilechoice");
        const ttx = tanvas.getContext("2d");
        //            canvas.height = 1080;
        tanvas.height = 128;
        //            canvas.width = 1920;
        tanvas.width = 128;
        ttx.imageSmoothingEnabled = false;

    </script>

    <script src="myTile.js"></script>

    <script>
        const sanvas = document.getElementById("spritecanvas");
        const stx = sanvas.getContext("2d");


        sanvas.width = spritesheet.width;
        sanvas.height = spritesheet.height;

        sanvas.onclick = function(evt) {
            var rect = canvas.getBoundingClientRect();
            let pos = {
                x: evt.layerX,
                y: evt.layerY,
                scale: (spritesheet.width / 48),
                //                scale: (spritesheet.width / 16),
                scaleH: (spritesheet.height / 22),
                //                scaleH: (spritesheet.height/2),
            };

            let coord = [Math.floor(pos.x / pos.scale), Math.floor(pos.y / pos.scale)];

            myTile.x = coord[0];
            myTile.y = coord[1];
            ttx.clearRect(0, 0, tanvas.width, tanvas.height);
            stx.clearRect(0, 0, sanvas.width, sanvas.height);
            myTile.draw();

            console.log(`sanvas[${Math.floor(pos.x/pos.scale)},${Math.floor(pos.y/pos.scale)}]`);
            //            console.log(evt);

            stx.drawImage(spritesheet, 0, 0);

            stx.save();
            stx.beginPath();
            stx.lineWidth = 1;
            stx.strokeStyle = 'white';
            stx.strokeRect(coord[0] * pos.scale, coord[1] * pos.scale, pos.scale, pos.scale);
            stx.stroke();
            stx.closePath();
            stx.restore();

        }


//        dragElement(canvas);
        dragElement(tanvas);
        dragElement(sanvas);

    </script>



</body>

</html>
